<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Gestion Agences & V√©hicules</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 2rem; }
    .card { border: 1px solid #ccc; padding: 1rem; margin-bottom: 1.5rem; border-radius: 6px; }
    h2, h3 { margin-top: 0; }
    form { margin-top: 1rem; }
    input, select { display: block; margin: 0.3rem 0; padding: 0.4rem; width: 100%; max-width: 300px; }
    button { padding: 0.4rem 1rem; margin-top: 0.5rem; }
  </style>
</head>
<body>

  <h1>Ajouter une nouvelle agence</h1>
  <form action="/agences" method="POST">
    <input type="text" name="nom" placeholder="Nom" required>
    <input type="text" name="adresse" placeholder="Adresse" required>
    <input type="text" name="telephone" placeholder="T√©l√©phone" required>
    <input type="email" name="email" placeholder="Email" required>
    <button type="submit">Ajouter l'agence</button>
  </form>

  <hr>

  <h1>Liste des agences</h1>

  <% agences.forEach(agence => { %>
    <div class="card">
      <!-- Supprimer l'agence -->
      <form action="/agences/<%= agence.id %>?_method=DELETE" method="POST" onsubmit="return confirm('Supprimer cette agence ?');">
        <button type="submit">üóë Supprimer l'agence</button>
      </form>
      <form action="/agences/<%= agence.id %>?_method=PUT" method="POST">
        <input type="text" name="nom" placeholder="Nom" required value="<%= agence.nom %>">
        <input type="text" name="adresse" placeholder="Adresse" required value="<%= agence.adresse %>">
        <input type="text" name="telephone" placeholder="T√©l√©phone" required value="<%= agence.telephone %>">
        <input type="email" name="email" placeholder="Email" required value="<%= agence.email %>">
        <button type="submit">Modifier l'agence</button>
    </form>
    
      <br>
      <h2><%= agence.nom %></h2>
      <p><strong>Adresse :</strong> <%= agence.adresse %></p>
      <p><strong>T√©l√©phone :</strong> <%= agence.telephone %></p>
      <p><strong>Email :</strong> <%= agence.email %></p>


      <h3>V√©hicules :</h3>
      <% if (agence.Vehicules.length > 0) { %>
        <ul>
          <% agence.Vehicules.forEach(v => { %>
            <li>
              üöó <%= v.marque %> <%= v.modele %> - <%= v.immatriculation %> (<%= v.statut %>) - <%= v.prix_par_jour %> ‚Ç¨/jour

              <!-- Supprimer le v√©hicule -->
              <form action="/vehicules/<%= v.id %>?_method=DELETE" method="POST" style="display:inline;" onsubmit="return confirm('Supprimer ce v√©hicule ?');">
                <button type="submit">‚ùå</button>
              </form>
            </li>
          <% }) %>
        </ul>
      <% } else { %>
        <p>Aucun v√©hicule enregistr√©.</p>
      <% } %>

      <!-- Ajouter un v√©hicule -->
      <form action="/vehicules" method="POST">
        <h4>Ajouter un v√©hicule</h4>
        <input type="hidden" name="agenceId" value="<%= agence.id %>">
        <input type="text" name="marque" placeholder="Marque" required>
        <input type="text" name="modele" placeholder="Mod√®le" required>
        <input type="text" name="immatriculation" placeholder="Immatriculation" required>
        <input type="number" name="annee" placeholder="Ann√©e" required>
        <input type="number" name="prix_par_jour" placeholder="Prix par jour (‚Ç¨)" step="0.01" required>
        <select name="statut" required>
          <option value="disponible">Disponible</option>
          <option value="lou√©">Lou√©</option>
          <option value="en r√©paration">En r√©paration</option>
        </select>
        <button type="submit">Ajouter le v√©hicule</button>
      </form>
    </div>
  <% }) %>

</body>
</html>
